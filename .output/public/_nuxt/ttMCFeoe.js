import{d as _,_ as k,a as C}from"./yvkQpzKz.js";import P from"./MIL_dP3-.js";import{f as y}from"./CqlxHt8h.js";import{C as Y,D as M,l as $}from"./CVY3qs6v.js";import{d as j,r as n,o as E,t as d,z as o,x as e,A as N,M as u,P as B,Q as F,v as i,y as c}from"./BlKPe-h4.js";const S={class:"flex flex-col"},T={class:"mx-5 my-2 p-4 rounded-2xl border-blue-500 border-2"},U={class:"flex items-center justify-center gap-6 pb-4 mt-2"},V={class:"flex flex-col items-center"},I={class:"flex flex-col items-center"},L={class:"flex flex-col pl-2 mb-20"},z={class:""},A={class:"bg-gray-100"},G=["onClick"],H={key:1,class:"text-center text-gray-400 py-10"},Q="admin",ee=j({__name:"offDaySetting",setup(q){const r=n(),l=n(),f=n([]),p=n([]),m=async()=>{try{const s=await $fetch("/api/GETallOffdays");p.value=s.data,f.value=p.value.map(t=>({id:t.id,startOffDays:t.start_offDays,endOffDays:t.end_offDays,created_at:t.created_at,create_by:t.created_by}))}catch{alert("Fetch error")}};E(m);const b=async s=>{console.log("DeleteId"+s);try{await $fetch("/api/DeleteOffDays",{method:"DELETE",body:{id:s}})?await m():alert("Post Failed: No valid response")}catch{alert("Delete error")}},x=async()=>{try{const s={startOffDate:r.value?_(r.value).format("YYYY-MM-DD"):null,endOffDate:l.value?_(l.value).format("YYYY-MM-DD"):null,created_by:Q};await $fetch("/api/CreateOffDays",{method:"POST",body:s})?await m():alert("Post Failed: No valid response")}catch(s){console.error("PostData 失败:",s),alert("提交失敗")}};return(s,t)=>{const g=k,v=M,D=Y,h=P,O=C;return i(),d("div",null,[o(g,{title:"休假設定"}),e("div",S,[e("div",T,[t[4]||(t[4]=e("div",{class:"flex justify-center bg-gray-200 bg-opacity-80 border shadow-sm p-1 mb-1"},[e("p",{class:"font-semibold text-lg"},"添加休假日")],-1)),e("div",U,[o(D,{locale:u($)},{default:N(()=>[e("div",V,[t[2]||(t[2]=e("p",{class:"mb-1 text-sm font-semibold"},"開始時間",-1)),o(v,{value:r.value,"onUpdate:value":t[0]||(t[0]=a=>r.value=a)},null,8,["value"])]),e("div",I,[t[3]||(t[3]=e("p",{class:"mb-1 text-sm font-semibold"},"結束時間",-1)),o(v,{value:l.value,"onUpdate:value":t[1]||(t[1]=a=>l.value=a)},null,8,["value"])])]),_:1},8,["locale"])]),e("div",{class:"flex justify-center"},[e("button",{class:"rounded-lg px-8 py-1 text-white text-sm bg-blue-500 hover:bg-blue-600",onClick:x}," 提交 ")])]),e("div",L,[t[6]||(t[6]=e("div",{class:"flex justify-center items-center gap-2 mb-2 mx-6 bg-white border border-gray-500 rounded-md shadow-sm"},[e("p",{class:"text-gray-500"}," 已设置的休假日期 ")],-1)),t[7]||(t[7]=e("div",{class:"grid grid-cols-[40px_4fr_4fr_2fr_80px] bg-gray-100 font-bold py-2 text-center text-gray-700 text-sm border-b border-gray-300"},[e("div",null,"序號"),e("div",null,"開始時間"),e("div",null,"結束時間"),e("div",null,"創建人"),e("div",null,"操作")],-1)),f.value.length>0?(i(!0),d(B,{key:0},F(f.value,(a,w)=>(i(),d("div",{key:w,class:"grid grid-cols-[40px_4fr_4fr_2fr_80px] text-center py-2 border-b border-gray-300 items-center text-sm"},[e("div",null,c(a.id),1),e("div",z,c(("formatDate"in s?s.formatDate:u(y))(a.startOffDays)),1),e("div",A,c(("formatDate"in s?s.formatDate:u(y))(a.endOffDays)),1),e("div",null,c(a.create_by),1),e("div",null,[e("button",{class:"px-3 py-1 text-red-500 border font-medium border-red-500 hover:bg-red-500 hover:text-white rounded-sm",onClick:J=>b(a.id)}," 刪除 ",8,G)])]))),128)):(i(),d("div",H,[o(h,{name:"ic:outline-event-busy",class:"w-10 h-10 mx-auto mb-2"}),t[5]||(t[5]=e("p",{class:"text-sm"},"還沒有設置任何休假",-1))]))])]),o(O)])}}});export{ee as default};
