import{_ as D,a as j}from"./yvkQpzKz.js";import N from"./MIL_dP3-.js";import{f as v}from"./CqlxHt8h.js";import{d as R,H as A,r as b,o as B,t as u,x as e,z as r,N as f,M as l,P as _,Q as F,v as m,y as n}from"./BlKPe-h4.js";const I={class:"flex justify-center mt-2 space-x-1"},P={class:"mb-20 bg-gray-50 pt-2 pb-2"},T={class:"flex justify-between items-center px-3 py-2 border-b border-gray-200 bg-gray-50 rounded-t-lg"},z={class:"px-3 flex items-center justify-center bg-white text-gray-800 text-sm border border-gray-300"},H={class:"flex items-center text-sm bg-gray-200 rounded-md px-2 py-1"},M={class:"flex flex-col px-4 py-3 space-y-2 text-sm text-gray-800"},U={class:"flex"},V={class:"flex"},E={class:"flex"},G={class:"flex-1 flex justify-between"},L={class:"flex"},Q={class:"flex items-center justify-between px-2 py-3 border-t border-gray-200 bg-gray-50 rounded-b-lg"},S={class:"flex items-center font-medium text-sm"},q={class:"ml-1 text-lg text-red-500"},J={class:"flex space-x-2"},K=["onClick"],O=["onClick"],W={key:1,class:"text-center text-gray-400 py-10"},st=R({__name:"approveRefund",setup(X){const{t:g}=A(),c=b([]),y=b([]),x=async s=>{try{const t=await $fetch("/api/GetAllRefund",{params:{filter:s}});y.value=t.data,c.value=y.value.map(a=>({id:a.id,booking_id:a.booking_id,refund_amount:a.refund_amount,fullname:a.full_name,created_at:a.created_at,departure_loc:a.departure_loc,destination_loc:a.destination_loc,shuttle_date:a.shuttle_date,shuttle_time:a.shuttle_time,status:a.status}))}catch{alert("Fetch error")}},d=b("all"),p=s=>{d.value=s,x(s)};B(()=>{p("all")});const w=async s=>{try{const t=await $fetch("/api/ApproveRefund",{method:"PUT",body:{id:s,status:"approved"}});await x(d.value),console.log(`退款 ${s} 同意，狀態碼：`,t)}catch(t){console.error(`退款 ${s} 同意失敗：`,t)}},h=async s=>{try{const t=await $fetch("/api/ApproveRefund",{method:"PUT",body:{id:s,status:"rejected"}});await x(d.value),console.log(`退款 ${s} 拒絕，狀態碼：`,t)}catch(t){console.error(`退款 ${s} 拒絕失敗：`,t)}};return(s,t)=>{const a=D,i=N,$=j;return m(),u(_,null,[e("div",null,[r(a,{title:"退款審核"})]),e("div",I,[e("div",{class:f(["flex items-center gap-2 px-4 py-1 border border-blue-300 rounded-md shadow-sm w-fit",l(d)==="all"?"bg-blue-500 text-white":"bg-white text-blue-600"]),onClick:t[0]||(t[0]=o=>p("all"))},[r(i,{name:"material-symbols:border-all-rounded",class:"w-5 h-5"}),t[3]||(t[3]=e("p",{class:"text-sm font-medium"},"全部",-1))],2),e("div",{class:f(["flex items-center gap-2 px-4 py-1 border border-blue-300 rounded-md shadow-sm w-fit",l(d)==="null"?"bg-blue-500 text-white":"bg-white text-blue-600"]),onClick:t[1]||(t[1]=o=>p("null"))},[r(i,{name:"mingcute:bill-fill",class:"w-5 h-5"}),t[4]||(t[4]=e("p",{class:"text-sm font-medium"},"待批准的退款",-1))],2),e("div",{class:f(["flex items-center gap-2 px-4 py-1 border border-blue-300 rounded-md shadow-sm w-fit",l(d)==="approved"?"bg-blue-500 text-white":"bg-white text-blue-600"]),onClick:t[2]||(t[2]=o=>p("approved"))},[r(i,{name:"lets-icons:done-all-round",class:"w-5 h-5"}),t[5]||(t[5]=e("p",{class:"text-sm font-medium"},"已通过",-1))],2)]),e("div",P,[l(c).length>0?(m(!0),u(_,{key:0},F(l(c),(o,k)=>(m(),u("div",{class:"bg-white border border-gray-400 mx-2 mb-4 rounded-lg shadow-sm",key:k},[e("div",T,[e("div",z,[t[6]||(t[6]=e("p",{class:"text-gray-500"},"訂單ID：",-1)),e("p",null,n(o.id),1)]),e("div",H,[r(i,{name:"material-symbols:order-approve",class:"w-4 h-4 mr-1 text-blue-500"}),t[7]||(t[7]=e("span",{class:"mr-1"},"單號：",-1)),e("span",null,n(o.booking_id),1)])]),e("div",M,[e("div",U,[t[8]||(t[8]=e("span",{class:"w-24 text-gray-400"},"申請账号：",-1)),e("span",null,n(o.fullname),1)]),e("div",V,[t[9]||(t[9]=e("span",{class:"w-24 text-gray-400"},"申请时间：",-1)),e("span",null,n(("formatDate"in s?s.formatDate:l(v))(o.created_at)),1)]),e("div",E,[t[11]||(t[11]=e("span",{class:"w-24 text-gray-400"},"旅程：",-1)),e("span",G,[e("span",null,n(l(g)(`${o.departure_loc}`)),1),t[10]||(t[10]=e("span",null,"to",-1)),e("span",null,n(l(g)(`${o.destination_loc}`)),1)])]),e("div",L,[t[12]||(t[12]=e("span",{class:"w-24 text-gray-400"},"出車時間：",-1)),e("span",null,n(("formatDate"in s?s.formatDate:l(v))(o.shuttle_date))+" "+n(o.shuttle_time),1)])]),e("div",Q,[e("div",S,[t[13]||(t[13]=e("span",{class:"text-xl text-red-500"},"*",-1)),t[14]||(t[14]=e("span",{class:"ml-1 text-gray-500"},"退款金額：",-1)),t[15]||(t[15]=e("span",{class:"text-gray-500"},"NT$",-1)),e("span",q,n(o.refund_amount),1)]),e("div",J,[e("button",{class:"rounded border text-red-400 border-red-500 hover:bg-red-400 hover:text-white px-3 py-1 text-sm transition",onClick:C=>h(o.id)}," 拒絕退款 ",8,K),e("button",{class:"rounded bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 text-sm transition",onClick:C=>w(o.id)}," 同意退款 ",8,O)])])]))),128)):(m(),u("div",W,[r(i,{name:"ic:outline-inbox",class:"w-10 h-10 mx-auto mb-2"}),t[16]||(t[16]=e("p",{class:"text-sm"},"暫時沒有退款訂單",-1))]))]),e("div",null,[r($)])],64)}}});export{st as default};
